
# Diet-Nova Professional Nutrition Suite

Expert-level web application for clinical nutritionists and dietitians.

## Version 2.0.227

### Key Features
- **Exchange Calculator**: Precision macro planning based on standardized food exchanges.
- **Client Management**: Full HIPAA-style client profiles with follow-up visit tracking.
- **Growth Charts**: WHO & CDC pediatric growth monitoring with clinical interpretations.
- **NFPE**: Nutrition-Focused Physical Examination checklist.
- **Food Composition**: Detailed database for custom meal building.
- **Cloud Diet Templates**: Diet templates are now managed via Supabase.

---

## Update History
- **v2.0.227**: Fixed template mapping logic where cloud data wasn't populating the calculator fields properly (mapped `meat_lean_low` -> `meatLean` and `milk_high_whole` -> `milkWhole`).
- **v2.0.226**: Initial Supabase integration for diet templates.

---

## Technical Maintenance: Cloud Diet Templates

The "Quick Diet Templates" in the Meal Planner tool are now fetched from the Supabase table `diet_templates`.

### Database Setup (SQL)
Run this script in your Supabase SQL Editor to create the necessary table:

```sql
CREATE TABLE diet_templates (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    diet_type TEXT NOT NULL,
    macro_ratios TEXT NOT NULL,
    kcal INTEGER NOT NULL,
    starch NUMERIC DEFAULT 0,
    vegetables NUMERIC DEFAULT 0,
    fruits NUMERIC DEFAULT 0,
    legumes NUMERIC DEFAULT 0,
    milk_skimmed_low NUMERIC DEFAULT 0,
    milk_medium NUMERIC DEFAULT 0,
    milk_high_whole NUMERIC DEFAULT 0,
    meat_lean_low NUMERIC DEFAULT 0,
    meat_medium NUMERIC DEFAULT 0,
    meat_high NUMERIC DEFAULT 0,
    fat_sat NUMERIC DEFAULT 0,
    fat_mufa NUMERIC DEFAULT 0,
    fat_pufa NUMERIC DEFAULT 0,
    sugar NUMERIC DEFAULT 0,
    created_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable RLS for security (read-only for all)
ALTER TABLE diet_templates ENABLE ROW LEVEL SECURITY;
CREATE POLICY "Allow public read access" ON diet_templates FOR SELECT USING (true);
```

### Mapping Logic (Verified v2.0.227)
The application maps the database columns to the following internal exchange keys:
- `starch` -> `starch`
- `vegetables` -> `veg`
- `fruits` -> `fruit`
- `legumes` -> `legumes`
- `milk_skimmed_low` -> `milkSkim`
- `milk_medium` -> `milkLow`
- `milk_high_whole` -> `milkWhole`
- `meat_lean_low` -> `meatLean`
- `meat_medium` -> `meatMed`
- `meat_high` -> `meatHigh`
- `fat_sat` -> `fatsSat`
- `fat_mufa` -> `fatsMufa`
- `fat_pufa` -> `fatsPufa`
- `sugar` -> `sugar`

---
*Developed by Diet-Nova Team*
